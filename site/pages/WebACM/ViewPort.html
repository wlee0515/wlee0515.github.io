<html>
<head>
    <title>View Port</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="javascript/EarthModel.js"></script>
    <script src="javascript/glMatrix_v0_9_5.js"></script>
    <script src="javascript/glDrawFunctions.js"></script>
    <script src="javascript/ModelLibrary.js"></script>
    <script src="javascript/AnimationDirector.js"></script>
    <script src="javascript/SimulationDirector.js"></script>

    <script id="shader-fs" type="x-shader/x-fragment">
    precision mediump float;

    varying vec4 vColor;
    varying vec3 vLightWeighting;

    void main(void) {
    vec4 wColor;
    wColor[0] = vColor[0]*vLightWeighting[0];
    wColor[1] = vColor[1]*vLightWeighting[1];
    wColor[2] = vColor[2]*vLightWeighting[2];
    wColor[3] = vColor[3];
    gl_FragColor = wColor;
    }
    </script>

    <script id="shader-vs" type="x-shader/x-vertex">
    attribute vec3 aVertexPosition;
    attribute vec3 aVertexNormal;
    attribute vec4 aVertexColor;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;
    uniform mat3 uNMatrix;

    uniform vec3 uAmbientColor;

    uniform vec3 uLightingDirection;
    uniform vec3 uDirectionalColor;

    varying vec3 vLightWeighting;
    varying vec4 vColor;

    void main(void) {
    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);

    vec3 transformedNormal = uNMatrix * aVertexNormal;
    float directionalLightWeighting = max(dot(transformedNormal, uLightingDirection), 0.0);

    vLightWeighting = uAmbientColor + uDirectionalColor * directionalLightWeighting;

    vColor = aVertexColor;
    }
    </script>

    <script src="models/Aim9.txt"></script>
    <script src="models/Apache.txt"></script>
    <script src="models/f16.txt"></script>
    <script src="models/mig29.txt"></script>
    <script src="models/b17.txt"></script>
    <script src="models/Tank.txt"></script>
    <script src="definition/RunwayDefinition.txt"></script>
    <script>

        function init() {
            resize();
/*
            var wCanvas = document.getElementById("OutputCanvas");
            wCanvas.addEventListener("mousedown", canvasMouseDown, false);
            wCanvas.addEventListener("mouseup", canvasMouseUp, false);
            wCanvas.addEventListener("mousemove", canvasMouseMove, false);

            wCanvas.addEventListener('contextmenu', function (e) {
                e.preventDefault();
            }, false);

            initGL(wCanvas);


            UpdateModelSelection();
            UpdateSimModelSelection();

            processTick();
*/
        }

        function resize() {

            var wCanvas = document.getElementById("id_canvas_OutputCanvas");

            wCanvas.height = window.innerHeight;
            wCanvas.width = window.innerWidth;

            var wFakeHorizon = document.getElementById("id_canvas_canvas_bg_image");
            wFakeHorizon.height = 2.0*window.innerHeight;
            wFakeHorizon.width = window.innerWidth;

/*
            resizeGL(wCanvas);
*/
        }


        var gLastIterationTime = 0;
        var gDeltaTime = 25; //ms;
        var gTimeBuffer = 0;
        function processTick() {

            window.requestAnimationFrame(processTick);

            var wTimeNow = new Date().getTime();
            if (gLastIterationTime != 0) {
                var wElapsed = wTimeNow - gLastIterationTime;

                if (wElapsed < gDeltaTime) {
                    gTimeBuffer += wElapsed;
                }

                var wReDraw = false;
                while (gTimeBuffer > 0) {
                    gTimeBuffer -= gDeltaTime;
                    processTime(gDeltaTime / 1000);
                    wReDraw = true;
                }

                if (true == wReDraw) {
                    renderWindow();
                }
            }
            gLastIterationTime = wTimeNow;
        }

        
        function processTime(iDt) {

        }
        
        function renderWindow() {

        }


    </script>
    <style>
        body {
            margin: 0px;
            padding: 0px;
            overflow: hidden;
            -webkit-touch-callout: none; /* iOS Safari */
            -webkit-user-select: none; /* Safari */
            -khtml-user-select: none; /* Konqueror HTML */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome and Opera */
        }

        #id_canvas_canvas_bg_image {
            position: absolute;
            top:0;
            left:0;
            z-index:-10;
        }

        #id_splash_container {
            position: fixed;
            top: 0px;
            left: 0px;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #id_div_config_upload {
            background-color:white;
            border: 1px solid blue;
            width: 300px;
            height: 300px;
            padding: 10px;
        }

    </style>

</head>
<body onload="init()" onresize="resize()">
    <div id="id_div_OutputCanvas">
        <img src="image/horizon.jpg" id="id_canvas_canvas_bg_image">
        <canvas id="id_canvas_OutputCanvas"></canvas>
    </div>
    <div id="id_splash_container">
    <div id="id_div_config_upload">
        <span>Please Upload Configuration File</span>
        <br>
        <input type="file" id="id_input_fileUpload" />
        <br>
        <input type="button" id="id_input_Start" value="Start"/>
    </div>
</div>
</body>
</html>
